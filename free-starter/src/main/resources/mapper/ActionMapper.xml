<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.uiautofree.agent.dao.ActionMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.uiautofree.agent.domain.ActionDO">
        <id column="id" property="id"/>
        <result column="gmt_create" property="gmtCreate"/>
        <result column="gmt_modified" property="gmtModified"/>
        <result column="owner" property="owner"/>
        <result column="name" property="name"/>
        <result column="type" property="type"/>
        <result column="command" property="command"/>
        <result column="params" property="params"/>
        <result column="custom_config" property="customConfig"/>
        <result column="common" property="common"/>
        <result column="sample" property="sample"/>
        <result column="remark" property="remark"/>
        <result column="sub_action_ids" property="subActionIds"/>
        <result column="is_deleted" property="isDeleted"/>
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        id, gmt_create, gmt_modified, owner, name, type, command, params, custom_config, common, sample, remark,
        sub_action_ids, is_deleted
    </sql>


    <insert id="createAction" keyProperty="id" parameterType="com.uiautofree.agent.domain.ActionDO"
            useGeneratedKeys="true">
        insert into action(gmt_create, gmt_modified, owner, name, type, command, params, custom_config,
        common, sample, remark, sub_action_ids, is_deleted)
        values(#{gmtCreate,jdbcType=TIMESTAMP}, #{gmtCreate,jdbcType=TIMESTAMP},
        #{owner, jdbcType=VARCHAR}, #{name, jdbcType=VARCHAR},
        #{type, jdbcType=VARCHAR},#{command, jdbcType=VARCHAR},
        #{params, jdbcType=LONGVARCHAR},#{customConfig, jdbcType=LONGVARCHAR},#{common, jdbcType=INTEGER},
        #{sample, jdbcType=VARCHAR},#{remark, jdbcType=VARCHAR},#{subActionIds, jdbcType=VARCHAR},
        #{isDeleted, jdbcType=INTEGER})
    </insert>

    <select id="getById" resultMap="BaseResultMap" parameterType="java.lang.Long">
        select
        <include refid="Base_Column_List"/>
        from action
        where id=#{id, jdbcType=BIGINT}
    </select>
    <select id="getActionList" resultMap="BaseResultMap" parameterType="arraylist">
        select
        <include refid="Base_Column_List"/>
        from action
        where id=#{id, jdbcType=BIGINT}
    </select>
    <select id="getByCommand" resultMap="BaseResultMap" parameterType="java.lang.String">
        select
        <include refid="Base_Column_List"/>
        from action
        where command=#{command, jdbcType=VARCHAR}
    </select>
    <!-- String searchKey, String type, Integer common, Integer creatorId, int pageStart, int pageSize -->
    <select id="getActionsByParams" resultType="com.uiautofree.agent.domain.ActionDO">
        select
        <include refid="Base_Column_List"/>
        from action
        where
        is_deleted = 0
        <if test="searchKey!=null">
            and name like #{searchKey, jdbcType=VARCHAR}
        </if>
        <if test="type != null">
            and type = #{type, jdbcType=VARCHAR}
        </if>
        <if test="common != null">
            and common = #{common, jdbcType=INTEGER}
        </if>
        <if test="creatorId != null">
            and creatorId = #{creatorId, jdbcType=INTEGER}
        </if>
        order by id desc
        <if test="pageStart != null">
            limit #{pageStart, jdbcType=INTEGER}, #{pageSize, jdbcType=INTEGER}
        </if>
    </select>
    <select id="count" resultType="java.lang.Long">
        select
        count(id)
        from action
        where
        is_deleted = 0
        <if test="searchKey!=null">
            and name like #{searchKey, jdbcType=VARCHAR}
        </if>
        <if test="type != null">
            and type = #{type, jdbcType=VARCHAR}
        </if>
        <if test="common != null">
            and common = #{common, jdbcType=INTEGER}
        </if>
        <if test="creatorId != null">
            and creatorId = #{creatorId, jdbcType=INTEGER}
        </if>
    </select>

    <update id="update" parameterType="com.uiautofree.agent.domain.ActionDO">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update action
        <set>
            <if test="gmtCreate != null">
                gmt_create = #{gmtCreate,jdbcType=TIMESTAMP},
            </if>
            <if test="gmtModified != null">
                gmt_modified = #{gmtModified,jdbcType=TIMESTAMP},
            </if>
            <if test="owner != null">
                owner = #{owner,jdbcType=INTEGER},
            </if>
            <if test="name != null">
                name = #{name,jdbcType=VARCHAR},
            </if>
            <if test="type != null">
                type = #{type,jdbcType=VARCHAR},
            </if>
            <if test="command != null">
                command = #{command,jdbcType=VARCHAR},
            </if>
            <if test="params != null">
                params = #{params,jdbcType=LONGVARCHAR},
            </if>
            <if test="common != null">
                common = #{common,jdbcType=INTEGER},
            </if>
            <if test="sample != null">
                sample = #{sample,jdbcType=VARCHAR},
            </if>
            <if test="remark != null">
                remark = #{remark,jdbcType=VARCHAR},
            </if>
            <if test="subActionIds != null">
                sub_action_ids = #{subActionIds,jdbcType=VARCHAR},
            </if>
            <if test="isDeleted != null">
                is_deleted = #{isDeleted,jdbcType=INTEGER},
            </if>
            <if test="customConfig != null">
                custom_config = #{customConfig,jdbcType=LONGVARCHAR},
            </if>
        </set>
        where id = #{id,jdbcType=BIGINT}
    </update>
</mapper>
